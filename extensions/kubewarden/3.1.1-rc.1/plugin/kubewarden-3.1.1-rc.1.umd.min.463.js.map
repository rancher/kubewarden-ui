{"version":3,"file":"kubewarden-3.1.1-rc.1.umd.min.463.js","mappings":"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","sources":["webpack://kubewarden-3.1.1-rc.1/./components/PolicyReporter/ResourceTab.vue?48fa","webpack://kubewarden-3.1.1-rc.1/./components/PolicyReporter/ResourceTab.vue","webpack://kubewarden-3.1.1-rc.1/./components/PolicyReporter/ResourceTab.vue?cf38","webpack://kubewarden-3.1.1-rc.1/./components/PolicyReporter/ResourceTab.vue?6a24","webpack://kubewarden-3.1.1-rc.1/./components/PolicyReporter/ResourceTab.vue?3c2d"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, resolveComponent as _resolveComponent, withCtx as _withCtx, createBlock as _createBlock, unref as _unref, createVNode as _createVNode } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  \"data-testid\": \"resource-tab-loading\",\n  class: \"pr-tab__loading\"\n}\nconst _hoisted_2 = {\n  key: 1,\n  class: \"pr-tab__container\"\n}\nconst _hoisted_3 = { key: 0 }\nconst _hoisted_4 = { key: 1 }\nconst _hoisted_5 = [\"colspan\"]\nconst _hoisted_6 = { class: \"text-muted\" }\nconst _hoisted_7 = { class: \"details\" }\nconst _hoisted_8 = { class: \"col\" }\nconst _hoisted_9 = { class: \"title\" }\nconst _hoisted_10 = { class: \"col\" }\nconst _hoisted_11 = { class: \"title\" }\nconst _hoisted_12 = { class: \"col\" }\nconst _hoisted_13 = { class: \"title\" }\n\nimport {\n  ref, reactive, computed, onMounted, nextTick, getCurrentInstance\n} from 'vue';\nimport { useStore } from 'vuex';\nimport { RouteLocationNormalizedLoaded, RouteLocationRaw } from 'vue-router';\nimport isEmpty from 'lodash/isEmpty';\n\nimport { NAMESPACE } from '@shell/config/query-params';\n\nimport { BadgeState } from '@components/BadgeState';\nimport { Banner } from '@components/Banner';\nimport SortableTable from '@shell/components/SortableTable';\n\nimport { KUBEWARDEN, PolicyReport, PolicyReportResult, ClusterPolicyReport } from '@kubewarden/types';\nimport { POLICY_REPORTER_HEADERS } from '@kubewarden/config/table-headers';\nimport {\n  getFilteredReport,\n  getLinkForPolicy,\n  colorForResult,\n  colorForSeverity\n} from '@kubewarden/modules/policyReporter';\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'ResourceTab',\n  setup(__props) {\n\nconst store = useStore();\nlet route: RouteLocationNormalizedLoaded | null = null;\n\nconst t = store.getters['i18n/t'];\n\nconst report = ref<PolicyReport | ClusterPolicyReport | null>(null);\nconst resource = ref<any>(null);\nconst canGetKubewardenLinks = ref(false);\nconst headers = ref(POLICY_REPORTER_HEADERS);\n\nconst fetchState = reactive({ pending: true });\n\nconst isNamespaceResource = computed(() => resource.value?.type === NAMESPACE);\n\nfunction determineResource() {\n  if (route?.params?.resource && route?.params?.id) {\n    const id = route?.params.namespace ? `${ route?.params.namespace }/${ route?.params.id }` : route?.params.id;\n\n    resource.value = store.getters['cluster/byId'](route?.params.resource, id);\n  }\n}\n\nasync function fetchReports() {\n  if (resource.value) {\n    fetchState.pending = true;\n    report.value  = await getFilteredReport(store, resource.value);\n  }\n\n  fetchState.pending = false;\n}\n\nfunction getResourceValue(row: PolicyReportResult, val: string, needScope = false): string {\n  if (isNamespaceResource.value && needScope) {\n    if (row.scope && val in row.scope) {\n      const value = row.scope[val as keyof typeof row.scope];\n\n      return typeof value === 'string' ? value : '-';\n    }\n\n    return '-';\n  }\n\n  if (!isEmpty(row)) {\n    if (val in row) {\n      const value = row[val as keyof (PolicyReportResult)];\n\n      return typeof value === 'string' ? value : '-';\n    }\n  }\n\n  return '-';\n}\n\nfunction getPolicyLink(row: PolicyReportResult): RouteLocationRaw | undefined {\n  const link = getLinkForPolicy(store, row);\n\n  if (link) {\n    return link;\n  }\n}\n\nfunction severityColor(row: PolicyReportResult) {\n  if (row.result && row.severity) {\n    return colorForSeverity(row.severity);\n  }\n\n  return 'bg-muted';\n}\n\nfunction statusColor(row: PolicyReportResult) {\n  if (row.result) {\n    const color = colorForResult(row.result);\n    const bgColor = color.includes('sizzle') ? `${ color }-bg` : color.replace(/text-/, 'bg-');\n\n    return bgColor;\n  }\n\n  return 'bg-muted';\n}\n\nfunction formattedDisplayName(displayName: string): string {\n  return displayName\n    .replace(/^clusterwide-/, '') // Remove 'clusterwide-' prefix\n    .replace(/^namespaced-[^-]+-/, ''); // Remove 'namespaced-<namespace>-' prefix\n};\n\nonMounted(async() => {\n  // Ensure Vue Router is initialized before accessing `useRoute()`\n  if (!route) {\n    const instance = getCurrentInstance();\n\n    if (instance?.proxy?.$route) {\n      route = instance.proxy.$route;\n    } else {\n      return;\n    }\n  }\n\n  determineResource();\n\n  await nextTick();\n  await fetchReports();\n\n  const capSchema = store.getters['cluster/schemaFor'](KUBEWARDEN.CLUSTER_ADMISSION_POLICY);\n  const apSchema = store.getters['cluster/schemaFor'](KUBEWARDEN.ADMISSION_POLICY);\n\n  canGetKubewardenLinks.value = !!(capSchema || apSchema);\n});\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_router_link = _resolveComponent(\"router-link\")!\n\n  return (fetchState.pending)\n    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, _cache[0] || (_cache[0] = [\n        _createElementVNode(\"i\", { class: \"icon icon-lg icon-spinner icon-spin m-20\" }, null, -1)\n      ])))\n    : (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n        _createVNode(_unref(SortableTable), {\n          rows: report.value?.results,\n          headers: headers.value,\n          \"table-actions\": false,\n          \"row-actions\": false,\n          \"key-field\": \"policy\",\n          \"sub-expandable\": true,\n          \"sub-expand-column\": true,\n          \"sub-rows\": true,\n          paging: true,\n          \"rows-per-page\": 25,\n          \"extra-search-fields\": ['summary'],\n          \"default-sort-by\": \"status\"\n        }, {\n          \"col:policy\": _withCtx(({ row }) => [\n            (row.policy)\n              ? (_openBlock(), _createElementBlock(\"td\", _hoisted_3, [\n                  (canGetKubewardenLinks.value)\n                    ? (_openBlock(), _createBlock(_component_router_link, {\n                        key: 0,\n                        to: getPolicyLink(row)!\n                      }, {\n                        default: _withCtx(() => [\n                          _createElementVNode(\"span\", null, _toDisplayString(formattedDisplayName(row.policy)), 1)\n                        ]),\n                        _: 2\n                      }, 1032, [\"to\"]))\n                    : (_openBlock(), _createElementBlock(\"span\", _hoisted_4, _toDisplayString(formattedDisplayName(row.policy)), 1))\n                ]))\n              : _createCommentVNode(\"\", true)\n          ]),\n          \"col:severity\": _withCtx(({ row }) => [\n            _createElementVNode(\"td\", null, [\n              _createVNode(_unref(BadgeState), {\n                label: getResourceValue(row, 'severity'),\n                color: severityColor(row)\n              }, null, 8, [\"label\", \"color\"])\n            ])\n          ]),\n          \"col:status\": _withCtx(({ row }) => [\n            _createElementVNode(\"td\", null, [\n              _createVNode(_unref(BadgeState), {\n                label: getResourceValue(row, 'result'),\n                color: statusColor(row)\n              }, null, 8, [\"label\", \"color\"])\n            ])\n          ]),\n          \"sub-row\": _withCtx(({ row, fullColspan }) => [\n            _createElementVNode(\"td\", {\n              colspan: fullColspan,\n              class: \"pr-tab__sub-row\"\n            }, [\n              (row.message)\n                ? (_openBlock(), _createBlock(_unref(Banner), {\n                    key: 0,\n                    color: \"info\",\n                    class: \"message\"\n                  }, {\n                    default: _withCtx(() => [\n                      _createElementVNode(\"span\", _hoisted_6, _toDisplayString(_unref(t)('kubewarden.policyReporter.headers.policyReportsTab.message.title')) + \": \", 1),\n                      _createElementVNode(\"span\", null, _toDisplayString(row.message), 1)\n                    ]),\n                    _: 2\n                  }, 1024))\n                : _createCommentVNode(\"\", true),\n              _createElementVNode(\"div\", _hoisted_7, [\n                _createElementVNode(\"section\", _hoisted_8, [\n                  _createElementVNode(\"div\", _hoisted_9, _toDisplayString(_unref(t)('kubewarden.policyReporter.headers.policyReportsTab.category')), 1),\n                  _createElementVNode(\"span\", null, _toDisplayString(row.category || '-'), 1)\n                ]),\n                _createElementVNode(\"section\", _hoisted_10, [\n                  _createElementVNode(\"div\", _hoisted_11, _toDisplayString(_unref(t)('kubewarden.policyReporter.headers.policyReportsTab.properties.mutating')), 1),\n                  _createElementVNode(\"span\", null, _toDisplayString(row.properties['mutating'] || '-'), 1)\n                ]),\n                _createElementVNode(\"section\", _hoisted_12, [\n                  _createElementVNode(\"div\", _hoisted_13, _toDisplayString(_unref(t)('kubewarden.policyReporter.headers.policyReportsTab.properties.validating')), 1),\n                  _createElementVNode(\"span\", null, _toDisplayString(row.properties['validating'] || '-'), 1)\n                ])\n              ])\n            ], 8, _hoisted_5)\n          ]),\n          _: 1\n        }, 8, [\"rows\", \"headers\"])\n      ]))\n}\n}\n\n})","<script setup lang=\"ts\">\nimport {\n  ref, reactive, computed, onMounted, nextTick, getCurrentInstance\n} from 'vue';\nimport { useStore } from 'vuex';\nimport { RouteLocationNormalizedLoaded, RouteLocationRaw } from 'vue-router';\nimport isEmpty from 'lodash/isEmpty';\n\nimport { NAMESPACE } from '@shell/config/query-params';\n\nimport { BadgeState } from '@components/BadgeState';\nimport { Banner } from '@components/Banner';\nimport SortableTable from '@shell/components/SortableTable';\n\nimport { KUBEWARDEN, PolicyReport, PolicyReportResult, ClusterPolicyReport } from '@kubewarden/types';\nimport { POLICY_REPORTER_HEADERS } from '@kubewarden/config/table-headers';\nimport {\n  getFilteredReport,\n  getLinkForPolicy,\n  colorForResult,\n  colorForSeverity\n} from '@kubewarden/modules/policyReporter';\n\nconst store = useStore();\nlet route: RouteLocationNormalizedLoaded | null = null;\n\nconst t = store.getters['i18n/t'];\n\nconst report = ref<PolicyReport | ClusterPolicyReport | null>(null);\nconst resource = ref<any>(null);\nconst canGetKubewardenLinks = ref(false);\nconst headers = ref(POLICY_REPORTER_HEADERS);\n\nconst fetchState = reactive({ pending: true });\n\nconst isNamespaceResource = computed(() => resource.value?.type === NAMESPACE);\n\nfunction determineResource() {\n  if (route?.params?.resource && route?.params?.id) {\n    const id = route?.params.namespace ? `${ route?.params.namespace }/${ route?.params.id }` : route?.params.id;\n\n    resource.value = store.getters['cluster/byId'](route?.params.resource, id);\n  }\n}\n\nasync function fetchReports() {\n  if (resource.value) {\n    fetchState.pending = true;\n    report.value  = await getFilteredReport(store, resource.value);\n  }\n\n  fetchState.pending = false;\n}\n\nfunction getResourceValue(row: PolicyReportResult, val: string, needScope = false): string {\n  if (isNamespaceResource.value && needScope) {\n    if (row.scope && val in row.scope) {\n      const value = row.scope[val as keyof typeof row.scope];\n\n      return typeof value === 'string' ? value : '-';\n    }\n\n    return '-';\n  }\n\n  if (!isEmpty(row)) {\n    if (val in row) {\n      const value = row[val as keyof (PolicyReportResult)];\n\n      return typeof value === 'string' ? value : '-';\n    }\n  }\n\n  return '-';\n}\n\nfunction getPolicyLink(row: PolicyReportResult): RouteLocationRaw | undefined {\n  const link = getLinkForPolicy(store, row);\n\n  if (link) {\n    return link;\n  }\n}\n\nfunction severityColor(row: PolicyReportResult) {\n  if (row.result && row.severity) {\n    return colorForSeverity(row.severity);\n  }\n\n  return 'bg-muted';\n}\n\nfunction statusColor(row: PolicyReportResult) {\n  if (row.result) {\n    const color = colorForResult(row.result);\n    const bgColor = color.includes('sizzle') ? `${ color }-bg` : color.replace(/text-/, 'bg-');\n\n    return bgColor;\n  }\n\n  return 'bg-muted';\n}\n\nfunction formattedDisplayName(displayName: string): string {\n  return displayName\n    .replace(/^clusterwide-/, '') // Remove 'clusterwide-' prefix\n    .replace(/^namespaced-[^-]+-/, ''); // Remove 'namespaced-<namespace>-' prefix\n};\n\nonMounted(async() => {\n  // Ensure Vue Router is initialized before accessing `useRoute()`\n  if (!route) {\n    const instance = getCurrentInstance();\n\n    if (instance?.proxy?.$route) {\n      route = instance.proxy.$route;\n    } else {\n      return;\n    }\n  }\n\n  determineResource();\n\n  await nextTick();\n  await fetchReports();\n\n  const capSchema = store.getters['cluster/schemaFor'](KUBEWARDEN.CLUSTER_ADMISSION_POLICY);\n  const apSchema = store.getters['cluster/schemaFor'](KUBEWARDEN.ADMISSION_POLICY);\n\n  canGetKubewardenLinks.value = !!(capSchema || apSchema);\n});\n</script>\n\n<template>\n  <div v-if=\"fetchState.pending\" data-testid=\"resource-tab-loading\" class=\"pr-tab__loading\">\n    <i class=\"icon icon-lg icon-spinner icon-spin  m-20\" />\n  </div>\n  <div v-else class=\"pr-tab__container\">\n    <SortableTable\n      :rows=\"report?.results\"\n      :headers=\"headers\"\n      :table-actions=\"false\"\n      :row-actions=\"false\"\n      key-field=\"policy\"\n      :sub-expandable=\"true\"\n      :sub-expand-column=\"true\"\n      :sub-rows=\"true\"\n      :paging=\"true\"\n      :rows-per-page=\"25\"\n      :extra-search-fields=\"['summary']\"\n      default-sort-by=\"status\"\n    >\n      <template #col:policy=\"{ row }\">\n        <td v-if=\"row.policy\">\n          <template v-if=\"canGetKubewardenLinks\">\n            <router-link :to=\"getPolicyLink(row)!\">\n              <span>{{ formattedDisplayName(row.policy) }}</span>\n            </router-link>\n          </template>\n          <template v-else>\n            <span>{{ formattedDisplayName(row.policy) }}</span>\n          </template>\n        </td>\n      </template>\n      <template #col:severity=\"{ row }\">\n        <td>\n          <BadgeState\n            :label=\"getResourceValue(row, 'severity')\"\n            :color=\"severityColor(row)\"\n          />\n        </td>\n      </template>\n      <template #col:status=\"{ row }\">\n        <td>\n          <BadgeState\n            :label=\"getResourceValue(row, 'result')\"\n            :color=\"statusColor(row)\"\n          />\n        </td>\n      </template>\n\n      <!-- Sub-rows -->\n      <template #sub-row=\"{ row, fullColspan }\">\n        <td :colspan=\"fullColspan\" class=\"pr-tab__sub-row\">\n          <Banner v-if=\"row.message\" color=\"info\" class=\"message\">\n            <span class=\"text-muted\">\n              {{ t('kubewarden.policyReporter.headers.policyReportsTab.message.title') }}:\n            </span>\n            <span>{{ row.message }}</span>\n          </Banner>\n          <div class=\"details\">\n            <section class=\"col\">\n              <div class=\"title\">\n                {{ t('kubewarden.policyReporter.headers.policyReportsTab.category') }}\n              </div>\n              <span>{{ row.category || '-' }}</span>\n            </section>\n            <section class=\"col\">\n              <div class=\"title\">\n                {{ t('kubewarden.policyReporter.headers.policyReportsTab.properties.mutating') }}\n              </div>\n              <span>{{ row.properties['mutating'] || '-' }}</span>\n            </section>\n            <section class=\"col\">\n              <div class=\"title\">\n                {{ t('kubewarden.policyReporter.headers.policyReportsTab.properties.validating') }}\n              </div>\n              <span>{{ row.properties['validating'] || '-' }}</span>\n            </section>\n          </div>\n        </td>\n      </template>\n    </SortableTable>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n$error: #614EA2;\n\n// Need to override the default colors for these classes\n.pr-tab {\n  &__loading {\n    display: flex;\n    justify-content: center;\n  }\n\n  &__container {\n    .sizzle-warning-bg {\n      background-color: $error;\n      color: #fff;\n    }\n\n    .text-warning {\n      color: var(--warning) !important;\n    }\n\n    .text-darker {\n      color: var(--dark) !important;\n    }\n\n    .sizzle-warning {\n      color: $error;\n    }\n  }\n\n  &__sub-row {\n    background-color: var(--body-bg);\n    border-bottom: 1px solid var(--sortable-table-top-divider);\n    padding-left: 1rem;\n    padding-right: 1rem;\n\n    .message {\n      display: flex;\n      flex-direction: column;\n    }\n\n    .details {\n      display: flex;\n      flex-direction: row;\n\n      .col {\n        display: flex;\n        flex-direction: column;\n\n        section {\n          margin-bottom: 1.5rem;\n        }\n\n        .title {\n          color: var(--muted);\n          margin-bottom: 0.5rem;\n        }\n      }\n    }\n  }\n}\n\n</style>\n","import script from \"./ResourceTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ResourceTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ResourceTab.vue?vue&type=style&index=0&id=148d1445&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-148d1445\"]])\n\nexport default __exports__","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".pr-tab__loading[data-v-148d1445]{display:flex;justify-content:center}.pr-tab__container .sizzle-warning-bg[data-v-148d1445]{background-color:#614ea2;color:#fff}.pr-tab__container .text-warning[data-v-148d1445]{color:var(--warning)!important}.pr-tab__container .text-darker[data-v-148d1445]{color:var(--dark)!important}.pr-tab__container .sizzle-warning[data-v-148d1445]{color:#614ea2}.pr-tab__sub-row[data-v-148d1445]{background-color:var(--body-bg);border-bottom:1px solid var(--sortable-table-top-divider);padding-left:1rem;padding-right:1rem}.pr-tab__sub-row .message[data-v-148d1445]{display:flex;flex-direction:column}.pr-tab__sub-row .details[data-v-148d1445]{display:flex;flex-direction:row}.pr-tab__sub-row .details .col[data-v-148d1445]{display:flex;flex-direction:column}.pr-tab__sub-row .details .col section[data-v-148d1445]{margin-bottom:1.5rem}.pr-tab__sub-row .details .col .title[data-v-148d1445]{color:var(--muted);margin-bottom:.5rem}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-23.use[1]!../../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[2]!../../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[3]!../../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-23.use[4]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./ResourceTab.vue?vue&type=style&index=0&id=148d1445&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"51285298\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"names":["_hoisted_1","key","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_defineComponent","__name","setup","__props","store","useStore","route","t","getters","report","ref","resource","canGetKubewardenLinks","headers","POLICY_REPORTER_HEADERS","fetchState","reactive","pending","isNamespaceResource","computed","value","type","NAMESPACE","determineResource","params","id","namespace","async","fetchReports","getFilteredReport","getResourceValue","row","val","needScope","scope","isEmpty","getPolicyLink","link","getLinkForPolicy","severityColor","result","severity","colorForSeverity","statusColor","color","colorForResult","bgColor","includes","replace","formattedDisplayName","displayName","onMounted","instance","getCurrentInstance","proxy","$route","nextTick","capSchema","KUBEWARDEN","CLUSTER_ADMISSION_POLICY","apSchema","ADMISSION_POLICY","_ctx","_cache","_component_router_link","_resolveComponent","_openBlock","_createElementBlock","_createElementVNode","_createVNode","_unref","SortableTable","rows","results","paging","_withCtx","policy","_createBlock","to","default","_toDisplayString","_","_createCommentVNode","BadgeState","label","fullColspan","colspan","message","Banner","category","properties","__exports__","___CSS_LOADER_EXPORT___","push","module","content","__esModule","locals","exports","add"],"sourceRoot":""}