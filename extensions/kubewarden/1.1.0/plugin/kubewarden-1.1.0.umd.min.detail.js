(("undefined"!==typeof self?self:this)["webpackJsonpkubewarden_1_1_0"]=("undefined"!==typeof self?self:this)["webpackJsonpkubewarden_1_1_0"]||[]).push([[0],{"00ce":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[e._t("traceBanner"),e.rows?t("SortableTable",{attrs:{rows:e.rows,headers:e.TRACE_HEADERS,"table-actions":!1,"row-actions":!1,"key-field":"traceID","default-sort-by":"startTime","sub-expandable":!0,"sub-expand-column":!0,"sub-rows":!0,paging:!0,"rows-per-page":e.rowsPerPage},scopedSlots:e._u([{key:"col:mode",fn:function({row:a}){return[t("td",[t("BadgeState",{attrs:{label:e.capitalizeMessage(a.mode),color:e.modeColor(a.mode)}})],1)]}},{key:"col:operation",fn:function({row:a}){return[t("td",[e._v(" "+e._s(a.operation)+" ")])]}},{key:"sub-row",fn:function({row:a,fullColspan:r}){return[t("td",{staticClass:"sub-row",attrs:{colspan:r}},[t("div",{staticClass:"details"},[e.showLogs(a.logs)?[t("section",{staticClass:"col"},[t("div",{staticClass:"title"},[e._v(" Response ")]),a.logs.response?t("span",{staticClass:"text-info"},[e._v(" "+e._s(e.capitalizeMessage(a.logs.response))+" ")]):t("span",[e._v(" N/A ")])])]:[t("section",{staticClass:"col"},[t("div",{staticClass:"title"},[e._v(" Response Message ")]),a.response_message?t("span",{staticClass:"text-warning"},[e._v(" "+e._s(e.capitalizeMessage(a.response_message))+" ")]):t("span",[e._v(" N/A ")])]),t("section",{staticClass:"col"},[t("div",{staticClass:"title"},[e._v(" Response Code ")]),t("span",{staticClass:"text-info"},[e._v(" "+e._s(a.response_code?a.response_code:"N/A")+" ")])]),t("section",{staticClass:"col"},[t("div",{staticClass:"title"},[e._v(" Mutated ")]),t("span",{staticClass:"text-info"},[e._v(" "+e._s(a.mutated)+" ")])])]],2)])]}}],null,!1,866474010)}):e._e()],2)},s=[],i=a("e24b"),o=a("f17a"),n=a("0fb1"),l=a("d892"),c=a("5191"),u=a("90cd"),d={props:{rows:{type:Array,default:()=>[]}},components:{BadgeState:o["a"],SortableTable:n["b"]},data(){return{MODE_MAP:l["c"],TRACE_HEADERS:c["f"],OPERATION_MAP:l["e"]}},computed:{groupField(){return this.isPolicyServer?"policy_id":null},isPolicyServer(){return this.$route.params.resource===u["a"].POLICY_SERVER},rowsPerPage(){return this.isPolicyServer?40:20}},methods:{capitalizeMessage(e){return(null===e||void 0===e?void 0:e.charAt(0).toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))},modeColor(e){return this.MODE_MAP[e]},opColor(e){return this.OPERATION_MAP[e]},showLogs(e){return!Object(i["h"])(e)}}},p=d,m=(a("d360"),a("d802")),v=Object(m["a"])(p,r,s,!1,null,"490704fe",null);t["a"]=v.exports},"0cdc":function(e,t,a){var r=a("5eaa");t=r(!1),t.push([e.i,".policy__mode[data-v-e7caa404]{display:flex;align-items:center}.policy__mode i[data-v-e7caa404]{margin-left:5px;font-size:22px;color:var(--warning)}.gauges[data-v-e7caa404],.gaugesContainer[data-v-e7caa404]{display:flex}.gauges[data-v-e7caa404]{justify-content:space-around;flex-wrap:wrap;justify-content:left}.gauges .count-gauge[data-v-e7caa404]{width:46%;margin-bottom:10px;flex:initial}.gauges>*[data-v-e7caa404]{flex:1;margin-right:1.75%}",""]),e.exports=t},"1fc1":function(e,t,a){"use strict";a("efce")},"284d":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return e.$fetchState.pending?t("Loading"):t("div",[e.policyGauges?[t("div",{staticClass:"row"},[[t("div",{staticClass:"col span-6"},[t("h3",[e._v(" "+e._s(e.t("kubewarden.policyServer.policyGauge.byStatus"))+" ")]),t("div",{staticClass:"gauges mb-20"},e._l(e.policyGauges,(function(a,r){return t("CountGauge",{key:r,attrs:{total:e.relatedPoliciesTotal,useful:a.count||0,graphical:!1,"primary-color-var":"--sizzle-"+a.color,name:r}})})),1)])],e.emptyTraces?e._e():[t("div",{staticClass:"col span-6"},[t("h3",[e._v(" "+e._s(e.t("kubewarden.policyServer.policyGauge.traces"))+" ")]),t("div",{staticClass:"gauges mb-20"},e._l(e.tracesGauges,(function(a,r){return t("CountGauge",{key:r,attrs:{total:e.filteredValidations.length,useful:a.count||0,graphical:!1,"primary-color-var":"--sizzle-"+a.color,name:r}})})),1)])]],2)]:e._e(),t("ResourceTabs",{attrs:{mode:e.mode},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[t("Tab",{attrs:{name:"related-policies",label:"Policies",weight:99},scopedSlots:e._u([{key:"default",fn:function(){return[t("ResourceTable",{attrs:{rows:e.relatedPolicies||[],headers:e.RELATED_HEADERS,groupable:!0,"group-by":e.groupPreference,"table-actions":!0},scopedSlots:e._u([{key:"col:operation",fn:function({row:a}){return[t("td",[t("BadgeState",{attrs:{label:a.operation,color:e.color(a.operation)}})],1)]}}])})]},proxy:!0}])}),t("Tab",{attrs:{name:"policy-metrics",label:"Metrics",weight:98},scopedSlots:e._u([e.metricsService?{key:"default",fn:function(a){return[a.active?t("DashboardMetrics",{attrs:{"detail-url":e.metricsProxy,"summary-url":e.metricsProxy,"graph-height":"825px"}}):e._e()]}}:null],null,!0)},[e.monitoringStatus.installed&&e.metricsService?e._e():t("MetricsBanner",{attrs:{"metrics-service":e.metricsService,"metrics-type":e.metricsType,"monitoring-route":e.monitoringRoute,"reload-required":e.reloadRequired},on:{add:e.addDashboard}})],1),t("Tab",{attrs:{name:"policy-tracing",label:"Tracing",weight:97}},[[t("TraceTable",{attrs:{rows:e.filteredValidations},scopedSlots:e._u([{key:"traceBanner",fn:function(){return[e.emptyTraces?t("TraceBanner",{attrs:{"jaeger-service":e.jaegerService,"open-telemetry-service":e.openTelemetryService}}):e._e()]},proxy:!0}])})]],2)],1)],2)},s=[],i=a("9ce4"),o=a("da25"),n=a("f390"),l=a("b45b"),c=a("a8b9"),u=a("305c"),d=a("5000"),p=a("74c2"),m=a("c389"),v=a("15ca"),h=a("c422"),g=a("126f"),f=a("38de"),b=a("9ec3"),y=a("90cd"),_=a("5191"),w=a("e9a3"),S=a("2c30"),T=function(){var e=this,t=e._self._c;return t("div",[t("Banner",{attrs:{color:"warning"}},[e.openTelemetryService?e.jaegerService?t("span",[e._v(e._s(e.t("kubewarden.tracing.noRelatedTraces")))]):t("span",{directives:[{name:"clean-html",rawName:"v-clean-html",value:e.t("kubewarden.tracing.noJaeger",{},!0),expression:"t('kubewarden.tracing.noJaeger', {}, true)"}]}):t("span",{directives:[{name:"clean-html",rawName:"v-clean-html",value:e.t("kubewarden.tracing.noOpenTelemetry",{},!0),expression:"t('kubewarden.tracing.noOpenTelemetry', {}, true)"}]})])],1)},x=[],j=a("6418"),R={props:{openTelemetryService:{type:Object,default:null},jaegerService:{type:Object,default:null}},components:{Banner:j["a"]}},C=R,P=a("d802"),k=Object(P["a"])(C,T,x,!1,null,null,null),O=k.exports,E=a("00ce"),D={name:"PolicyServer",components:{CountGauge:p["a"],DashboardMetrics:m["a"],Loading:v["a"],MetricsBanner:S["a"],ResourceTabs:h["a"],ResourceTable:g["a"],Tab:f["a"],TraceBanner:O,TraceTable:E["a"]},mixins:[u["a"]],props:{mode:{type:String,default:o["r"]},value:{type:Object,required:!0}},async fetch(){const e=await Object(c["a"])({relatedPolicies:this.value.allRelatedPolicies(),policyGauges:this.value.policyGauges(),jaegerService:this.value.jaegerService(),openTelemetryService:this.value.openTelemetryService()}),t=(e,t)=>{Object(b["isEmpty"])(t)||(this[e]=t)};if(t("relatedPolicies",e.relatedPolicies),t("policyGauges",e.policyGauges),t("jaegerService",e.jaegerService),t("openTelemetryService",e.openTelemetryService),!Object(b["isEmpty"])(this.relatedPolicies)&&this.jaegerService&&(this.filteredValidations=await this.value.filteredValidations({service:this.jaegerService})),this.monitoringStatus.installed)try{var a;if(this.metricsProxy=await this.value.grafanaProxy(this.metricsType),this.metricsProxy)this.metricsService=await Object(l["b"])("v2",this.$store,null===(a=this.currentCluster)||void 0===a?void 0:a.id,this.metricsProxy)}catch(s){console.error("Error fetching Grafana service: "+s)}else{await this.$store.dispatch("catalog/load");const e=this.$store.getters["catalog/rawCharts"],t=Object.values(e),a=t.find(e=>"rancher-monitoring"===e.chartName);var r;if(a)this.monitoringRoute={name:"c-cluster-apps-charts-install",params:{cluster:this.$route.params.cluster,product:this.$store.getters["productId"]},query:{[o["h"]]:"cluster",[o["g"]]:"rancher-charts",[o["d"]]:"rancher-monitoring",[o["o"]]:null===(r=a.versions[0])||void 0===r?void 0:r.version}}}},data(){return{RELATED_HEADERS:_["d"],jaegerService:null,openTelemetryService:null,filteredValidations:null,metricsProxy:null,metricsService:null,monitoringRoute:null,policyGauges:null,relatedPolicies:null,reloadRequired:!1,metricsType:y["g"].POLICY_SERVER}},computed:{...Object(i["a"])(["currentCluster","currentProduct"]),...Object(n["c"])(),_group:Object(d["m"])(d["e"]),emptyTraces(){return Object(b["isEmpty"])(this.filteredValidations)},groupPreference(){const e="namespace"===this._group?"kind":null;return e},relatedPoliciesTotal(){return Object(b["isEmpty"])(this.relatedPolicies)?0:this.relatedPolicies.length},tracesGauges(){return this.emptyTraces?null:this.value.tracesGauges(this.filteredValidations)}},methods:{async addDashboard(e){try{await this.value.addGrafanaDashboard(this.metricsType),e(!0),this.reloadRequired=!0}catch(t){Object(w["a"])({error:t,store:this.$store}),e(!1)}},hasNamespaceSelector(e){return e.namespaceSelector}}},A=D,M=(a("1fc1"),Object(P["a"])(A,r,s,!1,null,"e7caa404",null));t["default"]=M.exports},"2c30":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return e.monitoringStatus.installed?e.metricsDashboard?e.metricsService?e._e():t("div",[t("Banner",{attrs:{color:"error"}},[t("i",{staticClass:"icon icon-checkmark mr-10"}),t("span",{staticClass:"mb-20"},[e._v(" "+e._s(e.t("kubewarden.metrics.noService"))+" ")])])],1):t("div",[t("Banner",{attrs:{color:"warning"}},[e.reloadRequired?[t("i",{staticClass:"icon icon-checkmark mr-10"}),t("span",{staticClass:"mb-20"},[e._v(" "+e._s(e.t("kubewarden.metrics.reload"))+" ")]),t("button",{staticClass:"ml-10 btn btn-sm role-primary",on:{click:function(t){return e.reload()}}},[e._v(" "+e._s(e.t("generic.reload"))+" ")])]:[t("p",{staticClass:"mb-20"},[e._v(" "+e._s(e.t("kubewarden.metrics.notInstalled"))+" ")]),t("AsyncButton",{attrs:{mode:"grafanaDashboard"},on:{click:function(t){return e.$emit("add",t)}}})]],2)],1):t("div",[t("Banner",{attrs:{color:"warning"}},[t("span",{directives:[{name:"clean-html",rawName:"v-clean-html",value:e.t("kubewarden.monitoring.notInstalled",{},!0),expression:"t('kubewarden.monitoring.notInstalled', {}, true)"}]}),t("button",{staticClass:"btn role-primary ml-10",on:{click:function(t){return t.preventDefault(),e.chartRoute.apply(null,arguments)}}},[e._v(" "+e._s(e.t("kubewarden.policyServer.noDefaultsInstalled.button"))+" ")])])],1)},s=[],i=a("9ce4"),o=a("f390"),n=a("907c"),l=a("6418"),c=a("d709"),u={name:"MetricsBanner",props:{metricsService:{type:[Boolean,Object],default:null},metricsType:{type:String,required:!0},reloadRequired:{type:Boolean,default:!1}},components:{AsyncButton:c["b"],Banner:l["a"]},async fetch(){this.monitoringChart||await this.$store.dispatch("catalog/load"),await this.$store.dispatch("cluster/findAll",{type:n["c"]})},computed:{...Object(i["a"])(["currentProduct"]),...Object(o["c"])(),monitoringChart(){return this.$store.getters["catalog/chart"]({chartName:"rancher-monitoring"})},metricsDashboard(){const e=this.$store.getters["cluster/matching"]({type:n["c"],selector:"kubewarden/part-of=cattle-kubewarden-system"});return Array.isArray(e)&&!e.length?null:e}},methods:{reload(){this.$router.go()},chartRoute(){var e;null===(e=this.monitoringChart)||void 0===e||e.goToInstall()}}},d=u,p=a("d802"),m=Object(p["a"])(d,r,s,!1,null,null,null);t["a"]=m.exports},"733f":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("PolicyDetail",{attrs:{value:e.value,mode:e.mode,resource:e.resource}})},s=[],i=a("da25"),o=a("80db"),n={name:"AdmissionPolicy",props:{mode:{type:String,default:i["r"]},resource:{type:String,default:null},value:{type:Object,required:!0}},components:{PolicyDetail:o["a"]}},l=n,c=a("d802"),u=Object(c["a"])(l,r,s,!1,null,null,null);t["default"]=u.exports},"80db":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return e.$fetchState.pending?t("Loading"):t("div",[t("div",{staticClass:"mb-20"},[t("h3",[e._v(e._s(e.t("namespace.resources")))])]),t("ResourceTabs",{attrs:{mode:e.mode,"need-related":e.hasRelationships},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[e.hasRules?t("Tab",{attrs:{name:"policy-rules",label:"Rules",weight:99}},[t("RulesTable",{attrs:{rows:e.rulesRows}})],1):e._e(),t("Tab",{attrs:{name:"policy-tracing",label:"Tracing",weight:98}},[t("TraceTable",{attrs:{rows:e.tracesRows},scopedSlots:e._u([{key:"traceBanner",fn:function(){return[e.emptyTraces?t("Banner",{attrs:{color:"warning"}},[e.jaegerService?t("span",[e._v(e._s(e.t("kubewarden.tracing.noTraces")))]):t("span",{directives:[{name:"clean-html",rawName:"v-clean-html",value:e.t("kubewarden.tracing.noJaeger",{},!0),expression:"t('kubewarden.tracing.noJaeger', {}, true)"}]})]):e._e()]},proxy:!0}])})],1),t("Tab",{attrs:{name:"policy-metrics",label:"Metrics",weight:97},scopedSlots:e._u([e.metricsService?{key:"default",fn:function(a){return[a.active?t("DashboardMetrics",{attrs:{"detail-url":e.metricsProxy,"summary-url":e.metricsProxy,vars:e.dashboardVars,"graph-height":"825px"}}):e._e()]}}:null],null,!0)},[e.monitoringStatus.installed&&e.metricsService?e._e():t("MetricsBanner",{attrs:{"metrics-service":e.metricsService,"metrics-type":e.metricsType,"reload-required":e.reloadRequired},on:{add:e.addDashboard}})],1)],1)],1)},s=[],i=a("9ce4"),o=a("330a"),n=a.n(o),l=a("da25"),c=a("f390"),u=a("b45b"),d=a("305c"),p=a("6418"),m=a("c389"),v=a("15ca"),h=a("c422"),g=a("38de"),f=a("90cd"),b=a("2c30"),y=function(){var e=this,t=e._self._c;return t("div",[e.rows.length>0?t("SortableTable",{attrs:{rows:e.rows,headers:e.RULE_HEADERS,"table-actions":!1,"row-actions":!1,"key-field":"traceID","default-sort-by":"startTime"},scopedSlots:e._u([{key:"col:apiGroup",fn:function({row:a}){return[t("td",[t("span",[e._v(e._s(a.apiGroups||"-"))])])]}},{key:"col:apiVersion",fn:function({row:a}){return[t("td",[t("span",[e._v(e._s(a.apiVersions||"-"))])])]}},{key:"col:operations",fn:function({row:a}){return[t("td",[t("span",[e._v(e._s(e.joinColumn(a.operations)))])])]}},{key:"col:resources",fn:function({row:a}){return[t("td",[t("span",[e._v(e._s(e.joinColumn(a.resources)))])])]}}],null,!1,1857136105)}):t("div",[t("Banner",{staticClass:"type-banner mb-20 mt-0",attrs:{color:"warning",label:e.t("kubewarden.policies.noRules")}})],1)],1)},_=[],w=a("0fb1"),S=a("5191"),T={props:{rows:{type:Array,default:()=>[]}},components:{Banner:p["a"],SortableTable:w["b"]},data(){return{RULE_HEADERS:S["e"]}},methods:{joinColumn(e){return(null===e||void 0===e?void 0:e.join(", "))||""}}},x=T,j=a("d802"),R=Object(j["a"])(x,y,_,!1,null,null,null),C=R.exports,P=a("00ce"),k={name:"PolicyDetail",components:{Banner:p["a"],DashboardMetrics:m["a"],Loading:v["a"],MetricsBanner:b["a"],ResourceTabs:h["a"],RulesTable:C,Tab:g["a"],TraceTable:P["a"]},mixins:[d["a"]],props:{mode:{type:String,default:l["r"]},resource:{type:String,default:null},value:{type:Object,required:!0}},async fetch(){if(this.monitoringStatus.installed)try{var e;if(this.metricsProxy=await this.value.grafanaProxy(this.metricsType),this.metricsProxy)this.metricsService=await Object(u["b"])("v2",this.$store,null===(e=this.currentCluster)||void 0===e?void 0:e.id,this.metricsProxy)}catch(t){console.error("Error fetching Grafana service: "+t)}this.jaegerService=await this.value.jaegerService(),this.jaegerService&&(this.filteredValidations=await this.value.jaegerSpecificValidations({service:this.jaegerService}))},data(){return{jaegerService:null,metricsProxy:null,metricsService:null,reloadRequired:!1,filteredValidations:null,metricsType:f["g"].POLICY}},computed:{...Object(i["a"])(["currentCluster"]),...Object(c["c"])(),dashboardVars(){var e;return{policy_name:"clusterwide-"+(null===(e=this.value)||void 0===e?void 0:e.id)}},emptyTraces(){return!!n()(this.filteredValidations)},hasRelationships(){var e;return!(null===(e=this.value.metadata)||void 0===e||!e.relationships)},hasRules(){return!n()(this.rulesRows[0])},rulesRows(){var e;return null===(e=this.value.spec)||void 0===e?void 0:e.rules},tracesRows(){return this.filteredValidations?this.value.traceTableRows(this.filteredValidations):[]}},methods:{async addDashboard(e){try{await this.value.addGrafanaDashboard(this.metricsType),e(!0),this.reloadRequired=!0}catch(t){this.errors=t,e(!1)}}}},O=k,E=Object(j["a"])(O,r,s,!1,null,null,null);t["a"]=E.exports},a7cb:function(e,t,a){var r=a("5eaa");t=r(!1),t.push([e.i,".sub-row[data-v-490704fe]{background-color:var(--body-bg);border-bottom:1px solid var(--sortable-table-top-divider);padding-left:1rem;padding-right:1rem}.details[data-v-490704fe]{display:grid;grid-auto-flow:column;grid-auto-columns:minmax(0,1fr);gap:1em}.details .col[data-v-490704fe]{display:flex;flex-direction:column}.details .col section[data-v-490704fe]{margin-bottom:1.5rem}.details .col .title[data-v-490704fe]{color:var(--muted);margin-bottom:.5rem}",""]),e.exports=t},b3e2:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("PolicyDetail",{attrs:{value:e.value,mode:e.mode,resource:e.resource}})},s=[],i=a("da25"),o=a("80db"),n={name:"ClusterAdmissionPolicy",props:{mode:{type:String,default:i["r"]},resource:{type:String,default:null},value:{type:Object,required:!0}},components:{PolicyDetail:o["a"]}},l=n,c=a("d802"),u=Object(c["a"])(l,r,s,!1,null,null,null);t["default"]=u.exports},d360:function(e,t,a){"use strict";a("f608")},efce:function(e,t,a){var r=a("0cdc");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("0ed3").default;s("7ad780cd",r,!0,{sourceMap:!1,shadowMode:!1})},f608:function(e,t,a){var r=a("a7cb");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("0ed3").default;s("4ad7c6ba",r,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=kubewarden-1.1.0.umd.min.detail.js.map